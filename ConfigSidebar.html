<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <style>
    body {
      background-color: #0d1b2a; /* Dark blue */
      color: white; /* Font color white */
      font-family: Arial, sans-serif;
      padding: 10px;
    }
    .container {
      background: #1a2937; /* Slightly lighter dark blue for contrast */
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 20px;
    }
    h2, h3 {
      color: #ff6d01; /* Orange for headers, matching the button color */
      margin-bottom: 10px;
    }
    form {
      display: flex;
      flex-direction: column;
    }
    label, input, select, button {
      margin-bottom: 10px;
    }
    button {
      background-color: #ff6d01; /* Orange button */
      color: white;
      border: none;
      padding: 10px 20px;
      text-align: center;
      text-decoration: none;
      display: inline-block;
      font-size: 16px;
      margin: 4px 2hp;
      cursor: pointer;
      border-radius: 4px;
    }
    button:hover {
      opacity: 0.8;
    }
    select, input[type="number"] {
      padding: 8px;
      background: white;
      color: black;
      border-radius: 4px;
      border: 1px solid #ccc;
    }
    .hidden {
      display: none;
    }
    .loading {
      display: none;
      margin-top: 20px;
      text-align: center;
    }
    .loading span {
      display: block;
      margin-bottom: 10px;
    }
    .loading img {
      margin-top: 25px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>Importar Dados</h2>
    <form id="importDataForm">
      <label for="sheetSelect">Selecionar Consultor:</label>
      <select id="sheetSelect">
        <option value="all">Todos</option>
        <option value="MARCOS">MARCOS</option>
        <option value="WILLIAM">WILLIAM</option>
        <option value="GABRIEL">GABRIEL</option>
        <option value="FÁBIO">FÁBIO</option>
        <option value="ILDO">ILDO</option>
        <option value="GUILHERME">GUILHERME</option>
        <option value="LUANA">LUANA</option>
      </select>

      <label for="daySelect">Selecionar Dia:</label>
      <select id="daySelect">
        <option value="all">Todos</option>
        <option value="seg.">Segunda</option>
        <option value="ter.">Terça</option>
        <option value="qua.">Quarta</option>
        <option value="qui.">Quinta</option>
        <option value="sex.">Sexta</option>
      </select>

      <button type="button" onclick="runImport()">Importar Dados</button>
    </form>
  </div>

  <div class="loading" id="loading">
    <span>Importando dados, por favor aguarde...</span>
    <img src="https://upload.wikimedia.org/wikipedia/commons/b/b6/Loading_2_transparent.gif" alt="Loading" width="25" height="25">
  </div>

  <script>
    function runImport() {
      document.getElementById('loading').style.display = 'block';
      const selectedSheet = document.getElementById('sheetSelect').value;
      const selectedDay = document.getElementById('daySelect').value;
      google.script.run.withSuccessHandler(() => {
        alert('Importação de dados feita!');
        document.getElementById('loading').style.display = 'none';
      }).importDataFromSourceSheets(selectedSheet, selectedDay);
    }
  </script>
</body>
</html>
